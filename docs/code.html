
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>11. Anexos &#8212; Circle UP ⚫</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
    <link rel="stylesheet" type="text/css" href="../_static/custom.css?v=d536b92b" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="../_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'docs/code';</script>
    <script src="../_static/custom.js?v=16113e41"></script>
    <link rel="icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="10. Referencias" href="Referencias.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Circle UP ⚫ - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Circle UP ⚫ - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    CircleUp | Innovación Social
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Docs</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Introducci%C3%B3n.html">1. Introducción</a></li>
<li class="toctree-l1"><a class="reference internal" href="Marco%20Conceptual.html">2. Marco Conceptual</a></li>
<li class="toctree-l1"><a class="reference internal" href="Marco%20Metodol%C3%B3gico.html">3. Marco Metodológico</a></li>
<li class="toctree-l1"><a class="reference internal" href="Poblaci%C3%B3n.html">4. Población</a></li>

<li class="toctree-l1"><a class="reference internal" href="Articulaci%C3%B3n.html">5. Articulación</a></li>
<li class="toctree-l1"><a class="reference internal" href="Dise%C3%B1o%20%C3%81rboles.html">6. Diseño Árboles</a></li>
<li class="toctree-l1"><a class="reference internal" href="Cronograma.html">7. Cronograma de Gantt</a></li>


<li class="toctree-l1"><a class="reference internal" href="Cadena%20de%20Valor.html">8. Cadena de Valor</a></li>
<li class="toctree-l1"><a class="reference internal" href="Impactos%20y%20Beneficios.html">9. Impactos y Beneficios</a></li>

<li class="toctree-l1"><a class="reference internal" href="Referencias.html">10. Referencias</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">11. Anexos</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fdocs/code.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/docs/code.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>11. Anexos</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-y-visualizacion-de-datos-con-python">Análisis y Visualización de Datos con Python</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#categorizacion-de-datos">Categorización de Datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#formato-visual-de-categorias">Formato Visual de Categorías</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#carga-y-filtrado-de-microdatos-del-dane">Carga y Filtrado de Microdatos del DANE</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extraccion-de-metadatos">Extracción de Metadatos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unificacion-y-procesamiento-de-datos">Unificación y Procesamiento de Datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimacion-poblacional">Estimación Poblacional</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#desagregacion-y-analisis-de-datos">Desagregación y Análisis de Datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-de-distribuciones">Visualización de Distribuciones</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lista-de-variables-sociodemograficas">Lista de Variables Sociodemográficas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-datos-demograficos">Análisis de Datos Demográficos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#distribucion-de-edades-por-genero">Distribución de Edades por Género</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-de-la-distribucion-de-probabilidad">Visualización de la Distribución de Probabilidad</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#distribucion-de-satisfaccion-con-la-vida">Distribución de Satisfacción con la Vida</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="anexos">
<h1>11. Anexos<a class="headerlink" href="#anexos" title="Link to this heading">#</a></h1>
<section id="analisis-y-visualizacion-de-datos-con-python">
<h2>Análisis y Visualización de Datos con Python<a class="headerlink" href="#analisis-y-visualizacion-de-datos-con-python" title="Link to this heading">#</a></h2>
<p>Este código importa bibliotecas esenciales de Python para trabajar con datos. <code class="docutils literal notranslate"><span class="pre">pandas</span></code> se utiliza para manipular y analizar datos estructurados, <code class="docutils literal notranslate"><span class="pre">numpy</span></code> proporciona herramientas para cálculos numéricos, <code class="docutils literal notranslate"><span class="pre">seaborn</span></code> simplifica la creación de gráficos estadísticos atractivos y <code class="docutils literal notranslate"><span class="pre">matplotlib</span></code> permite personalizar visualizaciones de datos. Esta combinación de bibliotecas es fundamental para explorar, comprender y comunicar información a partir de conjuntos de datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="categorizacion-de-datos">
<h2>Categorización de Datos<a class="headerlink" href="#categorizacion-de-datos" title="Link to this heading">#</a></h2>
<p>Estas funciones en Python transforman valores numéricos (edad, horas, meses) en categorías discretas. Esto es útil para agrupar datos y facilitar el análisis, especialmente en áreas como demografía (categorías de edad) o análisis de comportamiento (categorías de horas trabajadas). Las categorías detalladas de edad podrían ser relevantes para estudios específicos que requieran mayor precisión en ciertos rangos de edad.</p>
<p><strong>Glosario:</strong></p>
<ul class="simple">
<li><p><strong>V (25-44 años):</strong> Voluntarios Académicos</p></li>
<li><p><strong>MI (14-24 años):</strong> Mentores Inversos</p></li>
<li><p><strong>LI (20-34 años):</strong> Lab Innovación</p></li>
<li><p><strong>PC:</strong> Participantes de CircleUp</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">age_category</span><span class="p">(</span><span class="n">edad</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">edad</span> <span class="o">&lt;</span> <span class="mi">18</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;0-17&#39;</span>
    <span class="k">elif</span> <span class="n">edad</span> <span class="o">&lt;</span> <span class="mi">25</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;18-24&#39;</span>
    <span class="k">elif</span> <span class="n">edad</span> <span class="o">&lt;</span> <span class="mi">35</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;25-34&#39;</span>
    <span class="k">elif</span> <span class="n">edad</span> <span class="o">&lt;</span> <span class="mi">45</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;35-44&#39;</span>
    <span class="k">elif</span> <span class="n">edad</span> <span class="o">&lt;</span> <span class="mi">55</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;45-54&#39;</span>
    <span class="k">elif</span> <span class="n">edad</span> <span class="o">&lt;</span> <span class="mi">65</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;55-64&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;65+&#39;</span>
    

<span class="k">def</span> <span class="nf">age_overall</span><span class="p">(</span><span class="n">edad</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">edad</span> <span class="o">&lt;</span> <span class="mi">15</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;0-14&#39;</span>
    <span class="k">elif</span> <span class="n">edad</span> <span class="o">&lt;</span> <span class="mi">60</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;15-59&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;60+&#39;</span>
    
<span class="k">def</span> <span class="nf">hour_category</span><span class="p">(</span><span class="n">hours</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">hours</span> <span class="o">&lt;</span> <span class="mi">18</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;0-17&#39;</span>
    <span class="k">elif</span> <span class="n">hours</span> <span class="o">&lt;</span> <span class="mi">35</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;18-34&#39;</span>
    <span class="k">elif</span> <span class="n">hours</span> <span class="o">&lt;</span> <span class="mi">45</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;35-44&#39;</span>
    <span class="k">elif</span> <span class="n">hours</span> <span class="o">&lt;</span> <span class="mi">55</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;45-54&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;55+&#39;</span>
    
<span class="k">def</span> <span class="nf">month_category</span><span class="p">(</span><span class="n">months</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">months</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;0-3&#39;</span>
    <span class="k">elif</span> <span class="n">months</span> <span class="o">&lt;</span> <span class="mi">7</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;4-6&#39;</span>
    <span class="k">elif</span> <span class="n">months</span> <span class="o">&lt;</span> <span class="mi">10</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;7-9&#39;</span>
    <span class="k">elif</span> <span class="n">months</span> <span class="o">&lt;</span> <span class="mi">13</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;10-12&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;12+&#39;</span>



<span class="k">def</span> <span class="nf">age_category_detailed</span><span class="p">(</span><span class="n">edad</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">edad</span> <span class="o">&lt;=</span> <span class="mi">13</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;0-13&#39;</span>
    <span class="k">elif</span> <span class="n">edad</span> <span class="o">&lt;=</span> <span class="mi">17</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;14-17&#39;</span>
    <span class="k">elif</span> <span class="n">edad</span> <span class="o">&lt;=</span> <span class="mi">19</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;18-19&#39;</span>
    <span class="k">elif</span> <span class="n">edad</span> <span class="o">&lt;=</span> <span class="mi">24</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;20-24&#39;</span>
    <span class="k">elif</span> <span class="n">edad</span> <span class="o">&lt;=</span> <span class="mi">29</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;25-29&#39;</span>
    <span class="k">elif</span> <span class="n">edad</span> <span class="o">&lt;=</span> <span class="mi">34</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;30-34&#39;</span>
    <span class="k">elif</span> <span class="n">edad</span> <span class="o">&lt;=</span> <span class="mi">39</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;35-39&#39;</span>
    <span class="k">elif</span> <span class="n">edad</span> <span class="o">&lt;=</span> <span class="mi">44</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;40-44&#39;</span>
    <span class="k">elif</span> <span class="n">edad</span> <span class="o">&lt;=</span> <span class="mi">49</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;45-49&#39;</span>
    <span class="k">elif</span> <span class="n">edad</span> <span class="o">&lt;=</span> <span class="mi">54</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;50-54&#39;</span>
    <span class="k">elif</span> <span class="n">edad</span> <span class="o">&lt;=</span> <span class="mi">59</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;55-59&#39;</span>
    <span class="k">elif</span> <span class="n">edad</span> <span class="o">&lt;=</span> <span class="mi">64</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;60-64&#39;</span>
    <span class="k">elif</span> <span class="n">edad</span> <span class="o">&lt;=</span> <span class="mi">69</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;65-69&#39;</span>
    <span class="k">elif</span> <span class="n">edad</span> <span class="o">&lt;=</span> <span class="mi">74</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;70-74&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;75+&#39;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="formato-visual-de-categorias">
<h2>Formato Visual de Categorías<a class="headerlink" href="#formato-visual-de-categorias" title="Link to this heading">#</a></h2>
<p>Estas funciones se utilizan para dar formato visual a las categorías de datos. La función <code class="docutils literal notranslate"><span class="pre">format_category</span></code> aplica estilos CSS específicos a las categorías ‘MI’, ‘PC’, ‘LI’ y ‘VA’ para resaltarlas visualmente. La función <code class="docutils literal notranslate"><span class="pre">age_format</span></code> asigna estas categorías a los rangos de edad correspondientes y devuelve una cadena de texto con el rango de edad y las categorías formateadas, listas para ser mostradas en una interfaz web o aplicación.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">format_category</span><span class="p">(</span><span class="n">category</span><span class="p">):</span>
    <span class="n">formats</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;MI&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;&lt;span class=&quot;mi&quot;&gt;(</span><span class="si">{</span><span class="n">category</span><span class="si">}</span><span class="s1">)&lt;/span&gt;&#39;</span><span class="p">,</span>
        <span class="s1">&#39;PC&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;&lt;span class=&quot;pc&quot;&gt;(</span><span class="si">{</span><span class="n">category</span><span class="si">}</span><span class="s1">)&lt;/span&gt;&#39;</span><span class="p">,</span>      
        <span class="s1">&#39;LI&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;&lt;span class=&quot;li&quot;&gt;(</span><span class="si">{</span><span class="n">category</span><span class="si">}</span><span class="s1">)&lt;/span&gt;&#39;</span><span class="p">,</span>     
        <span class="s1">&#39;VA&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;&lt;span class=&quot;va&quot;&gt;(</span><span class="si">{</span><span class="n">category</span><span class="si">}</span><span class="s1">)&lt;/span&gt;&#39;</span>          
    <span class="p">}</span>
    <span class="k">return</span> <span class="n">formats</span><span class="p">[</span><span class="n">category</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">age_format</span><span class="p">(</span><span class="n">rango</span><span class="p">):</span>
    <span class="n">categories</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;0-13&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;PC&#39;</span><span class="p">],</span>
        <span class="s1">&#39;14-17&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;MI&#39;</span><span class="p">,</span> <span class="s1">&#39;PC&#39;</span><span class="p">],</span>
        <span class="s1">&#39;18-19&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;MI&#39;</span><span class="p">,</span> <span class="s1">&#39;PC&#39;</span><span class="p">],</span>
        <span class="s1">&#39;20-24&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;MI&#39;</span><span class="p">,</span> <span class="s1">&#39;LI&#39;</span><span class="p">,</span> <span class="s1">&#39;PC&#39;</span><span class="p">],</span>
        <span class="s1">&#39;25-29&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;VA&#39;</span><span class="p">,</span> <span class="s1">&#39;LI&#39;</span><span class="p">,</span> <span class="s1">&#39;PC&#39;</span><span class="p">],</span>
        <span class="s1">&#39;30-34&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;VA&#39;</span><span class="p">,</span> <span class="s1">&#39;LI&#39;</span><span class="p">,</span> <span class="s1">&#39;PC&#39;</span><span class="p">],</span>
        <span class="s1">&#39;35-39&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;VA&#39;</span><span class="p">,</span> <span class="s1">&#39;PC&#39;</span><span class="p">],</span>
        <span class="s1">&#39;40-44&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;VA&#39;</span><span class="p">,</span> <span class="s1">&#39;PC&#39;</span><span class="p">],</span>
        <span class="s1">&#39;45-49&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;PC&#39;</span><span class="p">],</span>
        <span class="s1">&#39;50-54&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;PC&#39;</span><span class="p">],</span>
        <span class="s1">&#39;55-59&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;PC&#39;</span><span class="p">],</span>
        <span class="s1">&#39;60-64&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;PC&#39;</span><span class="p">],</span>
        <span class="s1">&#39;65-69&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;PC&#39;</span><span class="p">],</span>
        <span class="s1">&#39;70-74&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;PC&#39;</span><span class="p">],</span>
        <span class="s1">&#39;75+&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;PC&#39;</span><span class="p">]</span>
    <span class="p">}</span>
    
    <span class="n">cats</span> <span class="o">=</span> <span class="n">categories</span><span class="p">[</span><span class="n">rango</span><span class="p">]</span>
    <span class="n">formatted_cats</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">format_category</span><span class="p">(</span><span class="n">cat</span><span class="p">)</span> <span class="k">for</span> <span class="n">cat</span> <span class="ow">in</span> <span class="n">cats</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">rango</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">formatted_cats</span><span class="si">}</span><span class="s2">&quot;</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="carga-y-filtrado-de-microdatos-del-dane">
<h2>Carga y Filtrado de Microdatos del DANE<a class="headerlink" href="#carga-y-filtrado-de-microdatos-del-dane" title="Link to this heading">#</a></h2>
<p>Este código carga datos socioeconómicos del DANE (Departamento Administrativo Nacional de Estadística de Colombia) desde archivos CSV. La función <code class="docutils literal notranslate"><span class="pre">load_data</span></code> permite seleccionar un capítulo específico de los microdatos y filtrar los datos para incluir solo información correspondiente al municipio de Tocancipá (código 25817). Adicionalmente, la función puede renombrar las columnas del conjunto de datos utilizando un diccionario de características (<code class="docutils literal notranslate"><span class="pre">dfeatures</span></code>) para facilitar la interpretación y análisis de los datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adata</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;./Datos/DANE/Microdatos EM, (2021)/(Capítulo A).csv&#39;</span><span class="p">,</span> 
                    <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> 
                    <span class="n">encoding_errors</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">,</span> 
                    <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span><span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">dirs</span> <span class="o">=</span> <span class="n">adata</span><span class="p">[</span><span class="n">adata</span><span class="p">[</span><span class="s1">&#39;MPIO&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">25817</span><span class="p">][</span><span class="s1">&#39;DIRECTORIO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
<span class="n">DIRECTORIO</span> <span class="o">=</span> <span class="n">dirs</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="n">chapter</span><span class="p">,</span><span class="n">dfeatures</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">  </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  DIRECTORIO: Identificador numérico de vivienda Tocancipa</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;./Datos/DANE/Microdatos EM, (2021)/(Capítulo </span><span class="si">{</span><span class="n">chapter</span><span class="si">}</span><span class="s1">).csv&#39;</span><span class="p">,</span> 
                    <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> 
                    <span class="n">encoding_errors</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">,</span> 
                    <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;;&#39;</span><span class="p">,</span><span class="n">low_memory</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;DIRECTORIO&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">DIRECTORIO</span><span class="p">)]</span>
  <span class="k">if</span> <span class="n">dfeatures</span><span class="p">:</span>
    <span class="n">long_columns</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">dfeatures</span><span class="p">[</span><span class="n">chapter</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    <span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">long_columns</span>
    <span class="k">return</span> <span class="n">data</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">data</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="extraccion-de-metadatos">
<h2>Extracción de Metadatos<a class="headerlink" href="#extraccion-de-metadatos" title="Link to this heading">#</a></h2>
<p>Este código extrae información relevante del archivo XML de metadatos de la Encuesta de Micronegocios del DANE (DANE-DIMPE-EM-2021.xml).</p>
<p><strong>Funcionalidades:</strong></p>
<ol class="arabic simple">
<li><p><strong>Organización de la Estructura de Datos:</strong> Crea diccionarios que relacionan capítulos de la encuesta con los archivos de datos correspondientes (<code class="docutils literal notranslate"><span class="pre">data_explorer</span></code>), y almacenan metadatos sobre las variables (nombres de variables y preguntas asociadas) para cada capítulo (<code class="docutils literal notranslate"><span class="pre">dfeatures</span></code>).</p></li>
<li><p><strong>Mapeo de Respuestas:</strong> La función <code class="docutils literal notranslate"><span class="pre">answers_mapping</span></code> permite obtener el mapeo entre los valores numéricos de las respuestas y las etiquetas de texto correspondientes para una pregunta específica en un capítulo determinado.</p></li>
<li><p><strong>Identificación de Valores Nulos y Preguntas Relevantes:</strong> Las funciones <code class="docutils literal notranslate"><span class="pre">bad_nulls</span></code> y <code class="docutils literal notranslate"><span class="pre">good_qstn</span></code> ayudan a identificar variables con alta o baja cantidad de valores nulos y a extraer las preguntas asociadas a las variables con pocos valores nulos. Esta información puede ser útil para comprender la calidad de los datos y para seleccionar variables relevantes para el análisis.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">xml.etree.ElementTree</span> <span class="k">as</span> <span class="nn">ET</span>

<span class="n">tree</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="s1">&#39;./Datos/DANE/Microdatos EM, (2021)/DANE-DIMPE-EM-2021.xml&#39;</span><span class="p">)</span>
<span class="n">root</span> <span class="o">=</span> <span class="n">tree</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span>

<span class="n">namespace</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;d&#39;</span><span class="p">:</span> <span class="s1">&#39;http://www.icpsr.umich.edu/DDI&#39;</span><span class="p">}</span>

<span class="n">groups</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ID&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;d:dataDscr/d:varGrp&#39;</span><span class="p">,</span> <span class="n">namespace</span><span class="p">)]</span>
<span class="n">files</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ID&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;d:fileDscr&#39;</span><span class="p">,</span> <span class="n">namespace</span><span class="p">)]</span>
<span class="n">chapters</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;A&#39;</span><span class="p">,</span><span class="s1">&#39;B&#39;</span><span class="p">,</span><span class="s1">&#39;C&#39;</span><span class="p">,</span><span class="s1">&#39;D&#39;</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">,</span><span class="s1">&#39;F&#39;</span><span class="p">,</span><span class="s1">&#39;G&#39;</span><span class="p">,</span><span class="s1">&#39;H&#39;</span><span class="p">,</span><span class="s1">&#39;I&#39;</span><span class="p">,</span><span class="s1">&#39;J&#39;</span><span class="p">,</span><span class="s1">&#39;K&#39;</span><span class="p">,</span><span class="s1">&#39;L&#39;</span><span class="p">,</span><span class="s1">&#39;M1&#39;</span><span class="p">,</span><span class="s1">&#39;M2&#39;</span><span class="p">]</span>
<span class="n">data_explorer</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">chapters</span><span class="p">,</span><span class="n">files</span><span class="p">))</span>

<span class="n">dfeatures</span> <span class="o">=</span> <span class="p">{}</span>

<span class="k">def</span> <span class="nf">get_qstn</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">subelem_name</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">namespaces</span><span class="p">:</span>
        <span class="n">subelem</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">subelem_name</span><span class="p">,</span> <span class="n">namespaces</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">subelem</span> <span class="o">=</span> <span class="n">parent</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="n">subelem_name</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">subelem</span><span class="o">.</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">if</span> <span class="n">subelem</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">default</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">subelem</span><span class="o">.</span><span class="n">text</span> <span class="k">if</span> <span class="n">subelem</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">default</span>

<span class="k">for</span> <span class="n">idx</span><span class="p">,</span><span class="n">file</span> <span class="ow">in</span> <span class="n">data_explorer</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">metadata</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">vars_file</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;.//d:var[@files=&quot;</span><span class="si">{</span><span class="n">file</span><span class="si">}</span><span class="s1">&quot;]&#39;</span><span class="p">,</span> <span class="n">namespace</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">vars_file</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span>
        <span class="n">qstn</span> <span class="o">=</span> <span class="n">get_qstn</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="s1">&#39;d:qstn/d:qstnLit&#39;</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="n">namespace</span><span class="p">)</span>
        <span class="n">catgry</span> <span class="o">=</span> <span class="n">get_qstn</span><span class="p">(</span><span class="n">var</span><span class="p">,</span> <span class="s1">&#39;d:catgry/d:qstnLit&#39;</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="n">namespace</span><span class="p">)</span>
        <span class="n">metadata</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">qstn</span>
    <span class="n">dfeatures</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span> <span class="o">=</span> <span class="n">metadata</span>

<span class="k">def</span> <span class="nf">answers_mapping</span><span class="p">(</span><span class="n">chapter</span><span class="p">,</span><span class="n">question</span><span class="p">):</span> 
    <span class="n">mapping_answer</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">files</span> <span class="o">=</span> <span class="n">data_explorer</span><span class="p">[</span><span class="n">chapter</span><span class="p">]</span>
    <span class="n">vars_file</span> <span class="o">=</span> <span class="n">root</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;.//d:var[@files=&quot;</span><span class="si">{</span><span class="n">files</span><span class="si">}</span><span class="s1">&quot;]&#39;</span><span class="p">,</span> <span class="n">namespace</span><span class="p">)</span>
    <span class="n">vars_file</span> <span class="o">=</span> <span class="p">[</span><span class="n">var</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">vars_file</span> <span class="k">if</span> <span class="n">var</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">question</span><span class="p">]</span>
    <span class="n">answer_types</span> <span class="o">=</span> <span class="n">vars_file</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="s1">&#39;.//d:catgry&#39;</span><span class="p">,</span> <span class="n">namespace</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">catgry</span> <span class="ow">in</span> <span class="n">answer_types</span><span class="p">:</span>
        <span class="n">key</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">get_qstn</span><span class="p">(</span><span class="n">catgry</span><span class="p">,</span> <span class="s1">&#39;d:catValu&#39;</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="n">namespace</span><span class="p">))</span>
        <span class="n">value</span> <span class="o">=</span> <span class="n">get_qstn</span><span class="p">(</span><span class="n">catgry</span><span class="p">,</span> <span class="s1">&#39;d:labl&#39;</span><span class="p">,</span> <span class="n">namespaces</span><span class="o">=</span><span class="n">namespace</span><span class="p">)</span>
        <span class="n">mapping_answer</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
    <span class="k">return</span> <span class="n">mapping_answer</span>


<span class="k">def</span> <span class="nf">bad_nulls</span><span class="p">(</span><span class="n">chapter</span><span class="p">,</span><span class="n">bads</span><span class="p">,</span><span class="n">goods</span><span class="p">):</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="n">chapter</span><span class="p">)</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">to_frame</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;nulls&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">bad</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;nulls&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">bads</span><span class="p">][</span><span class="s1">&#39;index&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">god</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;nulls&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">goods</span><span class="p">][</span><span class="s1">&#39;index&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">bad</span><span class="p">,</span><span class="n">god</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">re</span>

<span class="k">def</span> <span class="nf">good_qstn</span><span class="p">(</span><span class="n">chapter</span><span class="p">,</span><span class="n">bads</span><span class="p">,</span><span class="n">goods</span><span class="p">):</span>
    <span class="n">pattern</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;(.*)\n&#39;</span>
    <span class="n">good</span> <span class="o">=</span> <span class="n">bad_nulls</span><span class="p">(</span><span class="n">chapter</span><span class="p">,</span><span class="n">bads</span><span class="p">,</span><span class="n">goods</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">qstn</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">good</span><span class="p">):</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">pattern</span><span class="p">,</span> <span class="n">dfeatures</span><span class="p">[</span><span class="n">chapter</span><span class="p">][</span><span class="n">qstn</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">match</span><span class="p">:</span>
            <span class="n">question</span> <span class="o">=</span> <span class="n">match</span><span class="o">.</span><span class="n">group</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;#</span><span class="si">{</span><span class="n">idx</span><span class="si">}</span><span class="s1">(</span><span class="si">{</span><span class="n">qstn</span><span class="si">}</span><span class="s1">) | </span><span class="si">{</span><span class="n">question</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="unificacion-y-procesamiento-de-datos">
<h2>Unificación y Procesamiento de Datos<a class="headerlink" href="#unificacion-y-procesamiento-de-datos" title="Link to this heading">#</a></h2>
<p>Este código unifica y procesa los datos de múltiples capítulos de la Encuesta de Micronegocios del DANE.</p>
<p><strong>Funcionalidades Principales:</strong></p>
<ol class="arabic simple">
<li><p><strong>Mapeo de Respuestas:</strong> La función <code class="docutils literal notranslate"><span class="pre">map_dataframe</span></code> convierte las respuestas numéricas de los datos en etiquetas de texto descriptivas utilizando el mapeo obtenido del archivo XML de metadatos.</p></li>
<li><p><strong>Unificación de Datos por Capítulo:</strong> La función <code class="docutils literal notranslate"><span class="pre">unified_data</span></code> combina los datos demográficos (Capítulo E) con los datos de un capítulo específico, asegurando que solo se incluyan los registros que tienen información en ambos capítulos. También realiza el mapeo de respuestas para el capítulo seleccionado.</p></li>
<li><p><strong>Unificación de Múltiples Capítulos:</strong> La función <code class="docutils literal notranslate"><span class="pre">unified</span></code> unifica los datos de varios capítulos seleccionados (‘E’, ‘H’, ‘J’, ‘I’, ‘K’, ‘F’). Agrega categorías de edad (‘AGE_RANGE’, ‘AGE_DETAIL’) basadas en la variable ‘NPCEP4’ del capítulo E. También formatea las categorías de edad para su visualización (‘AGE_FORMAT’). Además, la función <code class="docutils literal notranslate"><span class="pre">multiple_merge</span></code> permite combinar los datos de los capítulos seleccionados mientras evita conflictos de nombres de columnas.</p></li>
<li><p><strong>Manejo de Valores Nulos:</strong> Aunque el código tiene comentarios que indican la posibilidad de eliminar columnas con muchos valores nulos, esta funcionalidad no está activa en la versión actual.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">functools</span> <span class="kn">import</span> <span class="n">reduce</span>

<span class="k">def</span> <span class="nf">map_dataframe</span><span class="p">(</span><span class="n">dataframe</span><span class="p">:</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span><span class="n">chapter</span><span class="p">):</span>

  <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">dataframe</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
    <span class="k">try</span><span class="p">:</span>
      <span class="n">mapped</span> <span class="o">=</span> <span class="n">answers_mapping</span><span class="p">(</span><span class="n">chapter</span><span class="p">,</span><span class="n">feature</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">mapped</span><span class="p">:</span>
        <span class="n">dataframe</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="o">=</span> <span class="n">dataframe</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">mapped</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
      <span class="k">pass</span>
  <span class="k">return</span> <span class="n">dataframe</span>


<span class="k">def</span> <span class="nf">unified_data</span><span class="p">(</span><span class="n">chapter</span><span class="p">):</span>

  <span class="n">nulls_allowed</span> <span class="o">=</span> <span class="mi">1000</span>

  <span class="n">demo_data</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
  <span class="n">demo_data</span><span class="p">[</span><span class="s1">&#39;AGE_RANGE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">demo_data</span><span class="p">[</span><span class="s1">&#39;NPCEP4&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">age_category</span><span class="p">)</span>
  <span class="n">demo_data</span><span class="p">[</span><span class="s1">&#39;AGE_DETAIL&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">demo_data</span><span class="p">[</span><span class="s1">&#39;NPCEP4&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">age_category_detailed</span><span class="p">)</span>
  <span class="c1"># demo_bad = list(bad_nulls(&#39;E&#39;,nulls_allowed,nulls_allowed)[0])</span>
  <span class="c1"># demo_data.drop(demo_bad,axis=&#39;columns&#39;,inplace=True)</span>
  <span class="n">demo_data</span> <span class="o">=</span> <span class="n">map_dataframe</span><span class="p">(</span><span class="n">demo_data</span><span class="p">,</span><span class="s1">&#39;E&#39;</span><span class="p">)</span>
  

  <span class="n">chapter_data</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="n">chapter</span><span class="p">)</span>
  <span class="c1"># chapter_bad = list(bad_nulls(chapter,nulls_allowed,nulls_allowed)[0])</span>
  <span class="c1"># chapter_data.drop(chapter_bad,axis=&#39;columns&#39;,inplace=True)</span>
  <span class="n">chapter_data</span> <span class="o">=</span> <span class="n">map_dataframe</span><span class="p">(</span><span class="n">chapter_data</span><span class="p">,</span><span class="n">chapter</span><span class="p">)</span>

  <span class="n">join_params</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DIRECTORIO&#39;</span><span class="p">,</span> <span class="s1">&#39;DIRECTORIO_HOG&#39;</span><span class="p">,</span> <span class="s1">&#39;DIRECTORIO_PER&#39;</span><span class="p">,</span> <span class="s1">&#39;SECUENCIA_P&#39;</span><span class="p">,</span><span class="s1">&#39;ORDEN&#39;</span><span class="p">]</span>
  <span class="n">dataset</span> <span class="o">=</span> <span class="n">demo_data</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">chapter_data</span><span class="p">,</span><span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span><span class="n">on</span><span class="o">=</span><span class="n">join_params</span><span class="p">)</span>

  <span class="k">return</span> <span class="n">dataset</span>

<span class="k">def</span> <span class="nf">multiple_merge</span><span class="p">(</span><span class="n">dfs</span><span class="p">,</span> <span class="n">on</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">merge_with_rename</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">):</span>
        <span class="c1"># Identificar columnas comunes que no son parte de &#39;on&#39;</span>
        <span class="n">common_cols</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">left</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">&amp;</span> <span class="nb">set</span><span class="p">(</span><span class="n">right</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">on</span><span class="p">)</span>
        
        <span class="c1"># Renombrar columnas comunes en el DataFrame de la derecha</span>
        <span class="n">rename_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">col</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">col</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">right</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s2">&quot;</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">common_cols</span><span class="p">}</span>
        <span class="n">right_renamed</span> <span class="o">=</span> <span class="n">right</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="n">rename_dict</span><span class="p">)</span>
        
        <span class="c1"># Realizar el merge</span>
        <span class="n">merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">left</span><span class="p">,</span> <span class="n">right_renamed</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">on</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="n">how</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">merged</span>

    <span class="c1"># Asignar nombres a los DataFrames si no los tienen</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">df</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">dfs</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s1">&#39;name&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="n">df</span><span class="o">.</span><span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">df</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;df_</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span>

    <span class="k">return</span> <span class="n">reduce</span><span class="p">(</span><span class="n">merge_with_rename</span><span class="p">,</span> <span class="n">dfs</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">unified</span><span class="p">():</span>
    <span class="n">join_params</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;DIRECTORIO&#39;</span><span class="p">,</span> <span class="s1">&#39;DIRECTORIO_HOG&#39;</span><span class="p">,</span> <span class="s1">&#39;DIRECTORIO_PER&#39;</span><span class="p">,</span> <span class="s1">&#39;SECUENCIA_P&#39;</span><span class="p">,</span> <span class="s1">&#39;ORDEN&#39;</span><span class="p">]</span>
    <span class="n">chapters</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="s1">&#39;I&#39;</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">,</span> <span class="s1">&#39;F&#39;</span><span class="p">]</span>
    <span class="n">datasets</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">for</span> <span class="n">chapter</span> <span class="ow">in</span> <span class="n">chapters</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="n">chapter</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">map_dataframe</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">chapter</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">chapter</span> <span class="o">==</span> <span class="s1">&#39;E&#39;</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;AGE_RANGE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;NPCEP4&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">age_category</span><span class="p">)</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;AGE_DETAIL&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;NPCEP4&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">age_category_detailed</span><span class="p">)</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;AGE_OVERALL&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;NPCEP4&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">age_overall</span><span class="p">)</span>
            <span class="n">data</span><span class="p">[</span><span class="s1">&#39;AGE_FORMAT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;NPCEP4&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">age_format</span><span class="p">(</span><span class="n">age_category_detailed</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
        <span class="c1"># if chapter == &#39;K&#39;:</span>
        <span class="c1">#    data[&#39;MONTH_RANGE&#39;] = data[&#39;NPCKP20A&#39;].apply(month_category)</span>
        <span class="c1"># # Asignar un nombre al DataFrame basado en el capítulo</span>
        <span class="n">data</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;chapter_</span><span class="si">{</span><span class="n">chapter</span><span class="si">}</span><span class="s1">&#39;</span>
        <span class="n">datasets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="n">big_data</span> <span class="o">=</span> <span class="n">multiple_merge</span><span class="p">(</span><span class="n">datasets</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="n">join_params</span><span class="p">)</span>
    
    <span class="n">big_data</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="n">col</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_chapter&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">if</span> <span class="s1">&#39;_chapter&#39;</span> <span class="ow">in</span> <span class="n">col</span> <span class="k">else</span> <span class="n">col</span> <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">big_data</span><span class="o">.</span><span class="n">columns</span><span class="p">]</span>
    
    <span class="k">return</span> <span class="n">big_data</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="estimacion-poblacional">
<h2>Estimación Poblacional<a class="headerlink" href="#estimacion-poblacional" title="Link to this heading">#</a></h2>
<p>Estas funciones en Python estiman características de la población de Tocancipá (Colombia) a partir de una muestra de la Encuesta de Micronegocios del DANE de 2021. Asumen una población de 39,416 en 2018 y un tamaño de muestra de 2,015.</p>
<p><strong>Funcionalidades:</strong></p>
<ul class="simple">
<li><p><strong><code class="docutils literal notranslate"><span class="pre">pop_estimate_raw(value)</span></code>:</strong> Calcula y muestra la proporción estimada, el valor estimado en la población, el intervalo de confianza del 95% y el error estándar relativo. Incluye una explicación y una advertencia sobre la posible subestimación debido al crecimiento poblacional.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">pop_estimate(value)</span></code>:</strong> Retorna el intervalo de confianza y el error estándar relativo en un formato más compacto.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">pop_estimate_range(value)</span></code>:</strong> Similar a <code class="docutils literal notranslate"><span class="pre">pop_estimate</span></code>, pero presenta el intervalo de confianza en un formato legible “Est. [límite inferior] a [límite superior] Pers.”.</p></li>
<li><p><strong><code class="docutils literal notranslate"><span class="pre">pop(value)</span></code>:</strong> Simplifica aún más el formato de salida, retornando solo el intervalo de confianza estimado “(límite inferior-límite superior)”. Si el valor de entrada es 0, retorna “(0-0)”.</p></li>
</ul>
<p><strong>Consideraciones Importantes:</strong></p>
<ul class="simple">
<li><p><strong>Subestimación:</strong> Las estimaciones pueden ser inferiores a los valores reales debido al crecimiento poblacional de Tocancipá desde 2018.</p></li>
<li><p><strong>Margen de Error:</strong> Los intervalos de confianza indican la incertidumbre asociada a las estimaciones. Un intervalo más amplio indica mayor incertidumbre.</p></li>
<li><p><strong>Error Estándar Relativo:</strong> Mide la precisión de la estimación en relación con su magnitud. Un valor más bajo indica mayor precisión.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>

<span class="k">def</span> <span class="nf">pop_estimate_raw</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="n">total_population_2018</span> <span class="o">=</span> <span class="mi">39416</span>
    <span class="n">total_sample_2021</span> <span class="o">=</span> <span class="mi">2015</span>
    <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="n">total_sample_2021</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Error: El valor está fuera de rango.&quot;</span>
    
    <span class="c1"># Calcular la proporción en la muestra</span>
    <span class="n">sample_proportion</span> <span class="o">=</span> <span class="n">value</span> <span class="o">/</span> <span class="n">total_sample_2021</span>
    
    <span class="c1"># Calcular el error estándar</span>
    <span class="n">standard_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">sample_proportion</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sample_proportion</span><span class="p">))</span> <span class="o">/</span> <span class="n">total_sample_2021</span><span class="p">)</span>
    
    <span class="c1"># Calcular el intervalo de confianza del 95%</span>
    <span class="n">confidence_interval</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">sample_proportion</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">standard_error</span><span class="p">)</span>
    
    <span class="c1"># Extrapolar a la población total</span>
    <span class="n">estimated_population_value</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">sample_proportion</span> <span class="o">*</span> <span class="n">total_population_2018</span><span class="p">)</span>
    <span class="n">estimated_population_interval</span> <span class="o">=</span> <span class="p">(</span>
        <span class="nb">round</span><span class="p">(</span><span class="n">confidence_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">total_population_2018</span><span class="p">),</span>
        <span class="nb">round</span><span class="p">(</span><span class="n">confidence_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">total_population_2018</span><span class="p">)</span>
    <span class="p">)</span>
    
    <span class="c1"># Calcular el error estándar relativo</span>
    <span class="n">relative_standard_error</span> <span class="o">=</span> <span class="p">(</span><span class="n">standard_error</span> <span class="o">/</span> <span class="n">sample_proportion</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    
    <span class="k">return</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">    Estimated proportion: </span><span class="si">{</span><span class="n">sample_proportion</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%,</span>
<span class="s2">    Estimated population value: </span><span class="si">{</span><span class="n">estimated_population_value</span><span class="si">}</span><span class="s2">,</span>
<span class="s2">    95% Confidence Interval: </span><span class="si">{</span><span class="n">estimated_population_interval</span><span class="si">}</span><span class="s2">,</span>
<span class="s2">    Relative Standard Error (%)&quot;: </span><span class="si">{</span><span class="n">relative_standard_error</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">%</span>
<span class="s2">    &quot;&quot;&quot;</span>
    <span class="c1"># Explanation:</span>
    <span class="c1"># La proporción estimada representa la fracción de la población que se estima posee </span>
    <span class="c1"># la característica de interés. Se calcula dividiendo el valor observado en la muestra </span>
    <span class="c1"># entre el tamaño total de la muestra.</span>
    
    <span class="c1"># Disclaimer:</span>
    <span class="c1"># Estas estimaciones están basadas en datos del censo de 2018 y </span>
    <span class="c1"># una muestra de 2021. Debido al rápido crecimiento poblacional de Tocancipá, es probable </span>
    <span class="c1"># que estas estimaciones subestimen los valores actuales. Los usuarios deben considerar </span>
    <span class="c1"># un margen de error adicional al interpretar estos resultados. Se recomienda utilizar </span>
    <span class="c1"># estas estimaciones como una referencia general y no como valores precisos para la </span>
    <span class="c1"># población actual de Tocancipá.</span>
    <span class="c1"># &quot;&quot;&quot;</span>

<span class="k">def</span> <span class="nf">pop_estimate</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="n">total_population_2018</span> <span class="o">=</span> <span class="mi">39416</span>
    <span class="n">total_sample_2021</span> <span class="o">=</span> <span class="mi">2015</span>
    <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="n">total_sample_2021</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Error: El valor está fuera de rango.&quot;</span>

    <span class="n">sample_proportion</span> <span class="o">=</span> <span class="n">value</span> <span class="o">/</span> <span class="n">total_sample_2021</span>

    <span class="n">standard_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">sample_proportion</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sample_proportion</span><span class="p">))</span> <span class="o">/</span> <span class="n">total_sample_2021</span><span class="p">)</span>
  
    <span class="n">confidence_interval</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">sample_proportion</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">standard_error</span><span class="p">)</span>
    
    <span class="n">estimated_population_interval</span> <span class="o">=</span> <span class="p">(</span>
        <span class="nb">round</span><span class="p">(</span><span class="n">confidence_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">total_population_2018</span><span class="p">),</span>
        <span class="nb">round</span><span class="p">(</span><span class="n">confidence_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">total_population_2018</span><span class="p">)</span>
    <span class="p">)</span>
    
    <span class="n">relative_standard_error</span> <span class="o">=</span> <span class="p">(</span><span class="n">standard_error</span> <span class="o">/</span> <span class="n">sample_proportion</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">estimated_population_interval</span><span class="si">}</span><span class="s1"> | </span><span class="si">{</span><span class="n">relative_standard_error</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span>


<span class="k">def</span> <span class="nf">pop_estimate_range</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="n">total_population_2018</span> <span class="o">=</span> <span class="mi">39416</span>
    <span class="n">total_sample_2021</span> <span class="o">=</span> <span class="mi">2015</span>
    <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="n">total_sample_2021</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;Error: El valor está fuera de rango.&quot;</span>

    <span class="n">sample_proportion</span> <span class="o">=</span> <span class="n">value</span> <span class="o">/</span> <span class="n">total_sample_2021</span>

    <span class="n">standard_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">sample_proportion</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sample_proportion</span><span class="p">))</span> <span class="o">/</span> <span class="n">total_sample_2021</span><span class="p">)</span>

    <span class="n">confidence_interval</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">sample_proportion</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">standard_error</span><span class="p">)</span>
    
    <span class="n">estimated_population_interval</span> <span class="o">=</span> <span class="p">(</span>
        <span class="nb">round</span><span class="p">(</span><span class="n">confidence_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">total_population_2018</span><span class="p">),</span>
        <span class="nb">round</span><span class="p">(</span><span class="n">confidence_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">total_population_2018</span><span class="p">)</span>
    <span class="p">)</span>
    
    <span class="n">relative_standard_error</span> <span class="o">=</span> <span class="p">(</span><span class="n">standard_error</span> <span class="o">/</span> <span class="n">sample_proportion</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;Est. </span><span class="si">{</span><span class="n">estimated_population_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1"> a </span><span class="si">{</span><span class="n">estimated_population_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1"> Pers.&#39;</span>


<span class="k">def</span> <span class="nf">pop</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">total_population_2018</span> <span class="o">=</span> <span class="mi">39416</span>
        <span class="n">total_sample_2021</span> <span class="o">=</span> <span class="mi">2015</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="n">total_sample_2021</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;Error: El valor está fuera de rango.&quot;</span>

        <span class="n">sample_proportion</span> <span class="o">=</span> <span class="n">value</span> <span class="o">/</span> <span class="n">total_sample_2021</span>
        

        <span class="n">standard_error</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">sample_proportion</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">sample_proportion</span><span class="p">))</span> <span class="o">/</span> <span class="n">total_sample_2021</span><span class="p">)</span>

        <span class="n">confidence_interval</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">norm</span><span class="o">.</span><span class="n">interval</span><span class="p">(</span><span class="mf">0.95</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">sample_proportion</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">standard_error</span><span class="p">)</span>
        
        <span class="n">estimated_population_interval</span> <span class="o">=</span> <span class="p">(</span>
            <span class="nb">round</span><span class="p">(</span><span class="n">confidence_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">total_population_2018</span><span class="p">),</span>
            <span class="nb">round</span><span class="p">(</span><span class="n">confidence_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">total_population_2018</span><span class="p">)</span>
        <span class="p">)</span>
        
        <span class="n">relative_standard_error</span> <span class="o">=</span> <span class="p">(</span><span class="n">standard_error</span> <span class="o">/</span> <span class="n">sample_proportion</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="n">estimated_population_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">estimated_population_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">:</span><span class="s1">,</span><span class="si">}</span><span class="s1">)&#39;</span>
    
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">-</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">)&#39;</span> 
</pre></div>
</div>
</div>
</div>
</section>
<section id="desagregacion-y-analisis-de-datos">
<h2>Desagregación y Análisis de Datos<a class="headerlink" href="#desagregacion-y-analisis-de-datos" title="Link to this heading">#</a></h2>
<p>Esta función <code class="docutils literal notranslate"><span class="pre">unstack_data</span></code> procesa datos de la Encuesta de Micronegocios del DANE para un capítulo y un conjunto de preguntas específicas.</p>
<p><strong>Funcionalidades:</strong></p>
<ol class="arabic simple">
<li><p><strong>Carga y Preprocesamiento:</strong> Carga datos del capítulo, crea categorías de edad y mes si las variables ‘NPCEP4’ y ‘NPCKP20A’ están presentes, y mapea respuestas numéricas a etiquetas de texto.</p></li>
<li><p><strong>Filtrado:</strong> Elimina filas con valores nulos en las preguntas de interés y selecciona las 15 categorías más frecuentes de la primera pregunta para un análisis más enfocado.</p></li>
<li><p><strong>Tabla Dinámica:</strong> Crea una tabla dinámica (pivot table) que cuenta las ocurrencias de cada combinación de respuestas a las dos primeras preguntas.</p></li>
<li><p><strong>Transformación y Enriquecimiento:</strong> Desapila la tabla dinámica para obtener un formato más adecuado para visualización, agrega columnas con el porcentaje acumulado y el intervalo de confianza (IC 95%) y error estándar relativo.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">unstack_data</span><span class="p">(</span><span class="n">chapter</span><span class="p">,</span><span class="n">questions</span><span class="p">,</span><span class="n">question_names</span><span class="p">,</span><span class="n">idx_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">idx</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
  <span class="n">data</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="n">chapter</span><span class="p">,</span> <span class="n">dfeatures</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>

  <span class="n">categry_columns</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s1">&#39;NPCEP4&#39;</span><span class="p">:[</span><span class="s1">&#39;AGE_RANGE&#39;</span><span class="p">,</span><span class="n">age_category</span><span class="p">],</span>
                    <span class="s1">&#39;NPCKP20A&#39;</span><span class="p">:[</span><span class="s1">&#39;MONTH_RANGE&#39;</span><span class="p">,</span><span class="n">month_category</span><span class="p">]</span>
                    <span class="p">}</span>

  <span class="k">for</span> <span class="n">cat_key</span><span class="p">,</span><span class="n">cat_name</span> <span class="ow">in</span> <span class="n">categry_columns</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>

    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="fm">__contains__</span><span class="p">(</span><span class="n">cat_key</span><span class="p">):</span>
      <span class="n">data</span><span class="p">[</span><span class="n">cat_name</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">cat_key</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">cat_name</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    
  <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="n">questions</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">)</span>

  <span class="k">for</span> <span class="n">qstn</span> <span class="ow">in</span> <span class="n">questions</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">qstn</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;AGE_RANGE&#39;</span><span class="p">,</span><span class="s1">&#39;MONTH_RANGE&#39;</span><span class="p">,</span><span class="s1">&#39;SALARY_RANGE&#39;</span><span class="p">]:</span>
      <span class="k">try</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="n">qstn</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">qstn</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int&#39;</span><span class="p">)</span>
        <span class="n">data</span><span class="p">[</span><span class="n">qstn</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">qstn</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">answers_mapping</span><span class="p">(</span><span class="n">chapter</span><span class="p">,</span> <span class="n">qstn</span><span class="p">))</span>
      <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Non Float Value&#39;</span><span class="p">)</span>

  <span class="n">top_5</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">questions</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">nlargest</span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">.</span><span class="n">index</span>
  <span class="n">data_filtered</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="n">questions</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">top_5</span><span class="p">)]</span>

  <span class="n">data_pivot</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">data_filtered</span><span class="p">,</span> <span class="n">values</span><span class="o">=</span><span class="s1">&#39;DIRECTORIO&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="n">questions</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">questions</span><span class="p">[</span><span class="mi">1</span><span class="p">]],</span> 
                                <span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
  
  <span class="n">sample_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Muestra (</span><span class="si">{</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">/</span><span class="mi">2015</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%)&#39;</span>
  <span class="n">data_stacked</span> <span class="o">=</span> <span class="n">data_pivot</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
  <span class="n">data_stacked</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">question_names</span> <span class="o">+</span> <span class="p">[</span><span class="n">sample_name</span><span class="p">]</span>
  <span class="n">data_stacked</span> <span class="o">=</span> <span class="n">data_stacked</span><span class="p">[</span><span class="n">data_stacked</span><span class="p">[</span><span class="n">sample_name</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">]</span>
  <span class="n">data_stacked</span> <span class="o">=</span> <span class="n">data_stacked</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="p">[</span><span class="n">question_names</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sample_name</span><span class="p">],</span> <span class="n">ascending</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">])</span>
  <span class="n">data_stacked</span> <span class="o">=</span> <span class="n">data_stacked</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>

  <span class="n">data_stacked</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="n">question_names</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  <span class="n">data_stacked</span><span class="p">[</span><span class="sa">f</span><span class="s1">&#39;Acumulado&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_stacked</span><span class="p">[</span><span class="n">sample_name</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span> <span class="o">*</span> <span class="mi">100</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">data_filtered</span><span class="p">))</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
  <span class="n">data_stacked</span><span class="p">[</span><span class="s1">&#39;IC 95% | % Standard Error&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_stacked</span><span class="p">[</span><span class="n">sample_name</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">pop_estimate</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)))</span>
  <span class="k">if</span> <span class="n">idx_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
    <span class="n">data_stacked</span><span class="o">.</span><span class="n">rename_axis</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="p">{</span><span class="n">question_names</span><span class="p">[</span><span class="n">idx</span><span class="p">]:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">idx_name</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">},</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
  
  <span class="k">return</span> <span class="n">data_stacked</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="visualizacion-de-distribuciones">
<h2>Visualización de Distribuciones<a class="headerlink" href="#visualizacion-de-distribuciones" title="Link to this heading">#</a></h2>
<p>Esta función <code class="docutils literal notranslate"><span class="pre">plot_hist_hue</span></code> crea gráficos para analizar la distribución de una variable (<code class="docutils literal notranslate"><span class="pre">question</span></code>) en diferentes categorías de otra variable (<code class="docutils literal notranslate"><span class="pre">hue</span></code>), proporcionando estimaciones poblacionales para cada categoría.</p>
<p><strong>Funcionalidades:</strong></p>
<ol class="arabic simple">
<li><p><strong>Distribución por Categoría:</strong> Genera histogramas (para variables numéricas) o diagramas de barras (para variables categóricas) para cada valor único de la variable <code class="docutils literal notranslate"><span class="pre">hue</span></code>.</p></li>
<li><p><strong>Etiquetado:</strong></p>
<ul class="simple">
<li><p>Muestra el valor y el porcentaje de cada barra.</p></li>
<li><p>Resalta la barra más alta en cada categoría.</p></li>
<li><p>Incluye el nombre de la categoría (<code class="docutils literal notranslate"><span class="pre">hue_value</span></code>), el total de observaciones en esa categoría, el porcentaje respecto al total general y una estimación del rango poblacional.</p></li>
</ul>
</li>
<li><p><strong>Formato y Diseño:</strong></p>
<ul class="simple">
<li><p>Ajusta automáticamente el tamaño de la figura según el número de categorías.</p></li>
<li><p>Personaliza el tamaño y estilo de las fuentes, los ejes y la cuadrícula.</p></li>
<li><p>Maximiza el espacio utilizado en la figura.</p></li>
<li><p>Opcionalmente, guarda la figura en un archivo.</p></li>
</ul>
</li>
</ol>
<p><strong>Parámetros:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">data</span></code>: DataFrame de Pandas que contiene los datos.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hue</span></code>: Nombre de la variable categórica que define las categorías.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">question</span></code>: Nombre de la variable a analizar.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>: Etiqueta para el eje X.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hue_name</span></code>: Nombre descriptivo de la variable <code class="docutils literal notranslate"><span class="pre">hue</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">image_name</span></code> (opcional): Nombre del archivo para guardar la figura.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_hist_hue</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">hue</span><span class="p">,</span> <span class="n">question</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">hue_name</span><span class="p">,</span><span class="n">image_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    
    <span class="n">font_size</span> <span class="o">=</span> <span class="mi">10</span>
    <span class="n">font_sub</span> <span class="o">=</span> <span class="mi">11</span>
    <span class="n">font_title</span> <span class="o">=</span> <span class="mi">11</span>
    
    <span class="n">df</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="n">question</span><span class="p">,</span> <span class="n">hue</span><span class="p">])</span>
    <span class="n">hue_values</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">hue</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">hue_values</span><span class="p">))</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hue_values</span><span class="p">)</span> <span class="o">+</span> <span class="n">cols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">//</span> <span class="n">cols</span>
    
    <span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mf">6.5</span><span class="o">*</span><span class="n">cols</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">rows</span><span class="p">),</span> <span class="n">squeeze</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="c1"># fig.suptitle(f&#39;Distribución Frec. | Total {len(df)} ({(len(df)*100/2015):.2f}%)\n{hue_name}&#39;, fontsize=font_title, fontweight=&#39;bold&#39;, y=0.95)</span>
    
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">hue_value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">hue_values</span><span class="p">):</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">axes</span><span class="p">[</span><span class="n">idx</span> <span class="o">//</span> <span class="n">cols</span><span class="p">,</span> <span class="n">idx</span> <span class="o">%</span> <span class="n">cols</span><span class="p">]</span>
        <span class="n">hue_data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">hue</span><span class="p">]</span> <span class="o">==</span> <span class="n">hue_value</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="n">pd</span><span class="o">.</span><span class="n">api</span><span class="o">.</span><span class="n">types</span><span class="o">.</span><span class="n">is_numeric_dtype</span><span class="p">(</span><span class="n">hue_data</span><span class="p">[</span><span class="n">question</span><span class="p">]):</span>
            <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">hue_data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">question</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sns</span><span class="o">.</span><span class="n">countplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">hue_data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">question</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
        
        <span class="n">total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">hue_data</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">patches</span><span class="p">:</span>
            <span class="n">height</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span>
            <span class="n">percentage</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="mi">100</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">height</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">total</span><span class="si">:</span><span class="s1">.1f</span><span class="si">}</span><span class="s1">%&#39;</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="nb">int</span><span class="p">(</span><span class="n">height</span><span class="p">)</span><span class="si">}</span><span class="se">\n</span><span class="s1">(</span><span class="si">{</span><span class="n">percentage</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">,</span> 
                        <span class="p">(</span><span class="n">p</span><span class="o">.</span><span class="n">get_x</span><span class="p">()</span> <span class="o">+</span> <span class="n">p</span><span class="o">.</span><span class="n">get_width</span><span class="p">()</span> <span class="o">/</span> <span class="mf">2.</span><span class="p">,</span> <span class="n">height</span><span class="p">),</span>
                        <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span>
                        <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">font_size</span><span class="p">)</span>
        
        <span class="n">heights</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">get_height</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">patches</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">patches</span><span class="p">[</span><span class="n">heights</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">heights</span><span class="p">))]</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s1">&#39;lightblue&#39;</span><span class="p">)</span>
        
        <span class="n">estimate</span> <span class="o">=</span> <span class="n">pop_estimate_range</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">total</span><span class="p">))</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Responde (</span><span class="si">{</span><span class="n">hue_value</span><span class="si">}</span><span class="s1">)</span><span class="se">\n</span><span class="s1">Total </span><span class="si">{</span><span class="n">total</span><span class="si">}</span><span class="s1"> (</span><span class="si">{</span><span class="p">(</span><span class="n">total</span><span class="o">*</span><span class="mi">100</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">))</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%) | </span><span class="si">{</span><span class="n">estimate</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">font_sub</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">font_sub</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Frecuencia&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">font_sub</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.7</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s1">&#39;major&#39;</span><span class="p">,</span> <span class="n">labelsize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
        
        <span class="n">ymax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">heights</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">*</span> <span class="mf">1.20</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">hue_values</span><span class="p">),</span> <span class="n">rows</span> <span class="o">*</span> <span class="n">cols</span><span class="p">):</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">delaxes</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="n">idx</span> <span class="o">//</span> <span class="n">cols</span><span class="p">,</span> <span class="n">idx</span> <span class="o">%</span> <span class="n">cols</span><span class="p">])</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mf">0.9</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">left</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">right</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">hspace</span><span class="o">=</span><span class="mf">0.55</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.12</span><span class="p">)</span>
    
    <span class="k">if</span> <span class="n">image_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;./circleup/figures&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">image_name</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">datasets</span> <span class="o">=</span> <span class="n">unified</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="lista-de-variables-sociodemograficas">
<h2>Lista de Variables Sociodemográficas<a class="headerlink" href="#lista-de-variables-sociodemograficas" title="Link to this heading">#</a></h2>
<p>Esta lista contiene nombres de variables relevantes para el análisis sociodemográfico y de salud, extraídas de la Encuesta de Micronegocios del DANE. Cada variable va acompañada de una breve descripción y su posible código en la encuesta (si está disponible).</p>
<p><strong>Demografía:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SEXO</span></code>: Sexo del encuestado.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AGE_RANGE</span></code>: Rango de edad del encuestado (categorizado).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NPCEP4</span></code>: Edad del encuestado (numérica).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ESTADO</span> <span class="pre">CIVIL</span></code>: Estado civil del encuestado (<code class="docutils literal notranslate"><span class="pre">NPCEP7</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">DONDE</span> <span class="pre">NACIO</span></code>: Lugar de nacimiento del encuestado (<code class="docutils literal notranslate"><span class="pre">NPCEP11A</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">UBICACION</span> <span class="pre">HACE</span> <span class="pre">5</span> <span class="pre">ANOS</span></code>: Ubicación del encuestado hace 5 años (<code class="docutils literal notranslate"><span class="pre">NPCEP13</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">OTRO</span> <span class="pre">PAIS-PAIS</span> <span class="pre">HACE</span> <span class="pre">5</span> <span class="pre">ANOS</span></code>: País de residencia hace 5 años si era diferente a Colombia (<code class="docutils literal notranslate"><span class="pre">NPCEP13D</span></code>).</p></li>
</ul>
<p><strong>Educación:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">EDUCACION</span> <span class="pre">NIVEL</span></code>: Nivel educativo alcanzado (<code class="docutils literal notranslate"><span class="pre">NPCHP4</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ASISTENCIA</span> <span class="pre">ESCOLAR</span></code>: Asistencia actual a alguna institución educativa (<code class="docutils literal notranslate"><span class="pre">NPCHP2</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ALFABETIZACION</span></code>: Nivel de alfabetización (<code class="docutils literal notranslate"><span class="pre">NPCHP1</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EDU</span> <span class="pre">DISCRIMINACION</span> <span class="pre">APARIENCIA</span> <span class="pre">FISICA</span></code>: Discriminación en educación por apariencia física (<code class="docutils literal notranslate"><span class="pre">NPCHP35E</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONDICION</span> <span class="pre">SOCIAL</span></code>: Discriminación en educación por condición social (<code class="docutils literal notranslate"><span class="pre">NPCHP35I</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EXTRANJERO</span></code>: Discriminación en educación por ser extranjero (<code class="docutils literal notranslate"><span class="pre">NPCHP35K</span></code>).</p></li>
</ul>
<p><strong>Actividades Culturales:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Deporte</span></code>: Participación en actividades deportivas (<code class="docutils literal notranslate"><span class="pre">NPCHP30B</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Teatro,</span> <span class="pre">Danza,</span> <span class="pre">Música</span></code>: Participación en actividades artísticas (<code class="docutils literal notranslate"><span class="pre">NPCHP30C</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Biblioteca</span></code>: Uso de bibliotecas (<code class="docutils literal notranslate"><span class="pre">NPCHP30E</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Lectura</span></code>: Hábito de lectura (<code class="docutils literal notranslate"><span class="pre">NPCHP30G</span></code>).</p></li>
</ul>
<p><strong>Trabajo:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SITUACION</span> <span class="pre">LABORAL</span></code>: Situación laboral actual (<code class="docutils literal notranslate"><span class="pre">NPCKP1</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TIPO</span> <span class="pre">LABOR</span></code>: Tipo de trabajo (<code class="docutils literal notranslate"><span class="pre">NPCKP17</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TIPO</span> <span class="pre">CONTRATO</span></code>: Tipo de contrato laboral (<code class="docutils literal notranslate"><span class="pre">NPCKP20</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MONTH_RANGE</span> <span class="pre">LABORADO</span></code>: Meses trabajados en el último año (categorizado).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MEDIO</span> <span class="pre">DE</span> <span class="pre">EMPLEARSE</span></code>: Cómo consiguió el empleo (<code class="docutils literal notranslate"><span class="pre">NPCKP22</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">UBICACION</span> <span class="pre">LABOR</span></code>: Lugar de trabajo (<code class="docutils literal notranslate"><span class="pre">NPCKPA46</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MODALIDAD</span> <span class="pre">VIRTUAL</span></code>: Si trabaja en modalidad virtual (<code class="docutils literal notranslate"><span class="pre">NPCKNP48</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TRA.</span> <span class="pre">COMUNITARIO</span> <span class="pre">NO</span> <span class="pre">REMUNERADO</span></code>: Participación en trabajo comunitario no remunerado (<code class="docutils literal notranslate"><span class="pre">NPCKP59G</span></code>).</p></li>
</ul>
<p><strong>Satisfacción:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">SATISFECHO</span> <span class="pre">CON:</span> <span class="pre">VIDA</span></code>: Nivel de satisfacción con la vida (<code class="docutils literal notranslate"><span class="pre">NPCJP9AA</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">INGRESOS</span></code>: Nivel de satisfacción con los ingresos (<code class="docutils literal notranslate"><span class="pre">NPCJP9AC</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SALUD</span></code>: Nivel de satisfacción con la salud (<code class="docutils literal notranslate"><span class="pre">NPCJP9AD</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TRABAJO</span></code>: Nivel de satisfacción con el trabajo (<code class="docutils literal notranslate"><span class="pre">NPCJP9AE</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">AMIGOS</span></code>: Nivel de satisfacción con los amigos (<code class="docutils literal notranslate"><span class="pre">NPCJP9AG</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">COMUNIDAD</span></code>: Nivel de satisfacción con la comunidad (<code class="docutils literal notranslate"><span class="pre">NPCJP9AK</span></code>).</p></li>
</ul>
<p><strong>TIC:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">FREQ</span> <span class="pre">USO</span> <span class="pre">INTERNET</span></code>: Frecuencia de uso de internet (<code class="docutils literal notranslate"><span class="pre">NPCIP4</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">USO</span> <span class="pre">DISPOSITIVOS</span></code>: Uso de dispositivos electrónicos (<code class="docutils literal notranslate"><span class="pre">NPCIP1</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">INTERNET</span> <span class="pre">VIVIENDA</span></code>: Acceso a internet en la vivienda (<code class="docutils literal notranslate"><span class="pre">NPCIP7A</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">INTERNET</span> <span class="pre">EDU</span></code>: Uso de internet para educación (<code class="docutils literal notranslate"><span class="pre">NPCIP8F</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">INT.</span> <span class="pre">ENTRETENIMIENTO</span></code>: Uso de internet para entretenimiento (<code class="docutils literal notranslate"><span class="pre">NPCIP7A</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TRABAJAR</span></code>: Uso de internet para trabajar (<code class="docutils literal notranslate"><span class="pre">NPCIP8K</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">REDES</span> <span class="pre">SOCIALES</span></code>: Uso de redes sociales (<code class="docutils literal notranslate"><span class="pre">NPCIP8C</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">WHATSAPP</span></code>: Uso de WhatsApp (<code class="docutils literal notranslate"><span class="pre">NPCIP16D</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NO</span> <span class="pre">USO</span> <span class="pre">INT.</span></code>: Razones para no usar internet (<code class="docutils literal notranslate"><span class="pre">NPCIP5</span></code>).</p></li>
</ul>
<p><strong>Salud:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ESTADO</span> <span class="pre">GENERAL</span></code>: Estado general de salud (<code class="docutils literal notranslate"><span class="pre">NPCFP12</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CANCER</span></code>: Diagnóstico de cáncer (<code class="docutils literal notranslate"><span class="pre">NPCFP14B</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TRANS.</span> <span class="pre">MENTALES</span></code>: Diagnóstico de trastornos mentales (<code class="docutils literal notranslate"><span class="pre">NPCFP14C</span></code>).</p></li>
</ul>
<p><strong>Nota:</strong> Es posible que algunos códigos de variables no estén completos o sean aproximados. Se recomienda consultar la documentación oficial del DANE para obtener información precisa sobre las variables y sus códigos.</p>
</section>
<section id="analisis-de-datos-demograficos">
<h2>Análisis de Datos Demográficos<a class="headerlink" href="#analisis-de-datos-demograficos" title="Link to this heading">#</a></h2>
<p>Este código filtra y transforma datos de la Encuesta de Micronegocios del DANE para analizar el lugar de nacimiento de mujeres jóvenes (20-34 años) con educación superior y acceso a internet para fines educativos en Tocancipá. Genera una tabla dinámica que cruza el género con el lugar de nacimiento, y aplica una función <code class="docutils literal notranslate"><span class="pre">pop</span></code> (no definida en el código) para estimar valores poblacionales a partir de los datos de la muestra.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">custom_data</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

<span class="n">education</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Técnico&#39;</span><span class="p">,</span> <span class="s1">&#39;Universitaria completa (con título)&#39;</span><span class="p">,</span><span class="s1">&#39;Especialización completa (con título)&#39;</span><span class="p">,</span><span class="s1">&#39;Universitaria  incompleta (sin título)&#39;</span><span class="p">,</span> <span class="s1">&#39;Tecnológico&#39;</span><span class="p">,</span><span class="s1">&#39;Maestría completa (con título)&#39;</span><span class="p">]</span>
<span class="c1"># education = [&#39;Media (10° - 13°)&#39;, &#39;Técnico&#39;,&#39;Tecnológico&#39;,&#39;Universitaria  incompleta (sin título)&#39;, &#39;Universitaria completa (con título)&#39;,&#39;Especialización completa (con título)&#39;]</span>
<span class="c1"># genere_filter = custom_data[&#39;SEXO&#39;] == &#39;Mujer&#39;</span>
<span class="c1"># location_filter = custom_data[&#39;NPCEP13D&#39;] == &#39;Venezuela&#39;</span>
<span class="n">edu_filter</span> <span class="o">=</span> <span class="n">custom_data</span><span class="p">[</span><span class="s1">&#39;NPCHP4&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">education</span><span class="p">)</span>
<span class="n">labor_filter</span> <span class="o">=</span> <span class="n">custom_data</span><span class="p">[</span><span class="s1">&#39;NPCKP1&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Trabajando&#39;</span>
<span class="n">internet_edu</span> <span class="o">=</span> <span class="n">custom_data</span><span class="p">[</span><span class="s1">&#39;NPCIP8F&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Si&#39;</span>
<span class="n">age_min</span> <span class="o">=</span> <span class="n">custom_data</span><span class="p">[</span><span class="s1">&#39;NPCEP4&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">20</span>
<span class="n">age_max</span> <span class="o">=</span> <span class="n">custom_data</span><span class="p">[</span><span class="s1">&#39;NPCEP4&#39;</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">34</span>
<span class="n">summary</span> <span class="o">=</span> <span class="n">custom_data</span><span class="p">[(</span><span class="n">age_min</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">age_max</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">edu_filter</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">internet_edu</span><span class="p">)]</span>

<span class="n">custom_data</span> <span class="o">=</span> <span class="n">summary</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">age</span> <span class="o">=</span> <span class="s1">&#39;NPCEP11A&#39;</span>
<span class="n">nombre</span> <span class="o">=</span> <span class="s1">&#39;Lugar Nacimiento&#39;</span>
<span class="n">nombre_fig</span> <span class="o">=</span> <span class="s1">&#39;fig-li-born&#39;</span>
<span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Lugar de Nacimiento - Población (LI)&#39;</span>

<span class="n">custom_data</span> <span class="o">=</span> <span class="n">custom_data</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;DIRECTORIO&#39;</span><span class="p">:</span><span class="s1">&#39;Muestra&#39;</span><span class="p">,</span><span class="n">age</span><span class="p">:</span><span class="n">nombre</span><span class="p">,</span><span class="s1">&#39;SEXO&#39;</span><span class="p">:</span><span class="s1">&#39;Genero&#39;</span><span class="p">,</span><span class="s1">&#39;NPCEP11A&#39;</span><span class="p">:</span><span class="s1">&#39;Lugar Nacimiento&#39;</span><span class="p">})</span>
<span class="n">custom_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">custom_data</span><span class="p">,</span><span class="n">values</span><span class="o">=</span><span class="s1">&#39;Muestra&#39;</span><span class="p">,</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Genero&#39;</span><span class="p">],</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">nombre</span><span class="p">],</span><span class="n">aggfunc</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">custom_data</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1"> </span><span class="si">{</span><span class="n">pop</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>Lugar Nacimiento</th>
      <th>Este municipio</th>
      <th>Otro municipio</th>
      <th>Otro país</th>
    </tr>
    <tr>
      <th>Genero</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Hombre</th>
      <td>8 (48-265)</td>
      <td>25 (299-680)</td>
      <td>1 (-19-58)</td>
    </tr>
    <tr>
      <th>Mujer</th>
      <td>3 (-8-125)</td>
      <td>40 (542-1,023)</td>
      <td>1 (-19-58)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="distribucion-de-edades-por-genero">
<h2>Distribución de Edades por Género<a class="headerlink" href="#distribucion-de-edades-por-genero" title="Link to this heading">#</a></h2>
<p>Este gráfico muestra cómo se distribuyen las edades de los individuos en diferentes grupos, diferenciando entre géneros (masculino y femenino). Permite visualizar si existen patrones o diferencias en la composición por edades entre ambos géneros.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_hist_hue</span><span class="p">(</span><span class="n">summary</span><span class="p">,</span> <span class="s1">&#39;SEXO&#39;</span><span class="p">,</span> <span class="s1">&#39;AGE_DETAIL&#39;</span><span class="p">,</span><span class="s1">&#39;Grupo Edad&#39;</span><span class="p">,</span><span class="s1">&#39;Genero&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/23edfaeab9ba30caa647eeed3102ce213fc8f5d3566a6c8fd83c0ab634ab86af.png" src="../_images/23edfaeab9ba30caa647eeed3102ce213fc8f5d3566a6c8fd83c0ab634ab86af.png" />
</div>
</div>
<section id="visualizacion-de-la-distribucion-de-probabilidad">
<h3>Visualización de la Distribución de Probabilidad<a class="headerlink" href="#visualizacion-de-la-distribucion-de-probabilidad" title="Link to this heading">#</a></h3>
<p>Esta función crea un histograma detallado que muestra cómo se distribuyen las respuestas a una pregunta específica de una encuesta. Resalta la probabilidad de cada respuesta, la media y la mediana, y el porcentaje de respuestas que caen dentro de dos desviaciones estándar de la media. Además, el histograma puede ser personalizado para mostrar etiquetas específicas para ciertas preguntas, lo que facilita la interpretación de los datos.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_hist</span><span class="p">(</span><span class="n">chapter</span><span class="p">,</span> <span class="n">question</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span><span class="nb">bin</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">image_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

    <span class="n">data</span> <span class="o">=</span> <span class="n">load_data</span><span class="p">(</span><span class="n">chapter</span><span class="p">)</span>
    <span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="n">question</span><span class="p">],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;any&#39;</span><span class="p">)</span>

    <span class="n">sns</span><span class="o">.</span><span class="n">set_style</span><span class="p">(</span><span class="s2">&quot;whitegrid&quot;</span><span class="p">)</span>
    <span class="n">sns</span><span class="o">.</span><span class="n">set_palette</span><span class="p">(</span><span class="s2">&quot;deep&quot;</span><span class="p">)</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    
    <span class="c1"># Calcular los bins y las frecuencias</span>
    <span class="n">counts</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">question</span><span class="p">],</span> <span class="n">bins</span><span class="o">=</span><span class="nb">bin</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    
    <span class="c1"># Calcular la media y la desviación estándar</span>
    <span class="n">media</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">question</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">desv_est</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">question</span><span class="p">]</span><span class="o">.</span><span class="n">std</span><span class="p">()</span>
    
    <span class="c1"># Calcular los límites para 2 desviaciones estándar</span>
    <span class="n">lower_bound</span> <span class="o">=</span> <span class="n">media</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">desv_est</span>
    <span class="n">upper_bound</span> <span class="o">=</span> <span class="n">media</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">desv_est</span>
    
    <span class="c1"># Encontrar los bins que caen dentro de 2 desviaciones estándar</span>
    <span class="n">within_2std</span> <span class="o">=</span> <span class="p">(</span><span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">lower_bound</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">&lt;=</span> <span class="n">upper_bound</span><span class="p">)</span>
    
    <span class="c1"># Calcular la probabilidad acumulada dentro de 2 desviaciones estándar</span>
    <span class="n">prob_acum</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">counts</span><span class="p">[</span><span class="n">within_2std</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">bins</span><span class="p">)[</span><span class="n">within_2std</span><span class="p">])</span>
    
    <span class="c1"># Crear el histograma</span>
    <span class="n">hist</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">histplot</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="n">question</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="n">bins</span><span class="p">,</span> <span class="n">stat</span><span class="o">=</span><span class="s1">&#39;probability&#39;</span><span class="p">,</span> 
                        <span class="n">multiple</span><span class="o">=</span><span class="s1">&#39;stack&#39;</span><span class="p">,</span> <span class="n">kde</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax</span><span class="p">)</span>
    
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">count</span><span class="p">,</span> <span class="n">bin_left</span><span class="p">,</span> <span class="n">bin_right</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">counts</span><span class="p">,</span> <span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:])):</span>
        <span class="k">if</span> <span class="n">within_2std</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axvspan</span><span class="p">(</span><span class="n">bin_left</span><span class="p">,</span> <span class="n">bin_right</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">)</span>
    
    <span class="n">kde_x</span><span class="p">,</span> <span class="n">kde_y</span> <span class="o">=</span> <span class="n">hist</span><span class="o">.</span><span class="n">lines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_data</span><span class="p">()</span>
    
    <span class="n">mediana</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">question</span><span class="p">]</span><span class="o">.</span><span class="n">median</span><span class="p">()</span>
    <span class="n">prob_mediana</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">mediana</span><span class="p">,</span> <span class="n">kde_x</span><span class="p">,</span> <span class="n">kde_y</span><span class="p">)</span>
    <span class="n">prob_media</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">media</span><span class="p">,</span> <span class="n">kde_x</span><span class="p">,</span> <span class="n">kde_y</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">mediana</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Mediana: </span><span class="si">{</span><span class="n">mediana</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">mediana</span><span class="p">,</span> <span class="n">prob_mediana</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="n">prob_mediana</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">media</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;dashed&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;Media: </span><span class="si">{</span><span class="n">media</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">media</span><span class="p">,</span> <span class="n">prob_media</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;(</span><span class="si">{</span><span class="n">prob_media</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%)&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;purple&#39;</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">)</span>

    <span class="n">total_datos</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="o">*</span><span class="mi">100</span><span class="o">/</span><span class="mi">2015</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Distribución Probabilidad | Muestra (</span><span class="si">{</span><span class="n">total_datos</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%)</span><span class="se">\n</span><span class="s1">&#39;</span>
                <span class="sa">f</span><span class="s1">&#39;Prob. Acum. (2σ): </span><span class="si">{</span><span class="n">prob_acum</span><span class="o">*</span><span class="mi">100</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">,</span> 
                <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Probabilidad&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">12</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>

    <span class="n">min_val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">question</span><span class="p">]</span><span class="o">.</span><span class="n">min</span><span class="p">()))</span>
    <span class="n">max_val</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">question</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()))</span>
    

    <span class="n">tick_labels</span>  <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">answers_mapping</span><span class="p">(</span><span class="n">chapter</span><span class="p">,</span><span class="n">question</span><span class="p">)</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">min_val</span><span class="p">,</span> <span class="n">max_val</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">question</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;NPCJP2&#39;</span><span class="p">,</span> <span class="s1">&#39;NPCJP6&#39;</span><span class="p">]:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">tick_labels</span><span class="p">)</span>
    
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="k">if</span> <span class="n">image_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span><span class="n">sx</span>
        <span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;./circleup/figures&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">path</span><span class="si">}</span><span class="s1">/</span><span class="si">{</span><span class="n">image_name</span><span class="si">}</span><span class="s1">.png&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span>  <span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">13</span><span class="p">],</span> <span class="n">line</span> <span class="mi">73</span>
    <span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;./circleup/figures&#39;</span>
    <span class="o">^</span>
<span class="ne">IndentationError</span>: unexpected indent
</pre></div>
</div>
</div>
</div>
</section>
<section id="distribucion-de-satisfaccion-con-la-vida">
<h3>Distribución de Satisfacción con la Vida<a class="headerlink" href="#distribucion-de-satisfaccion-con-la-vida" title="Link to this heading">#</a></h3>
<p>Este gráfico ilustra cómo se distribuyen las respuestas a la pregunta “¿Estás satisfecho con tu vida?” en una escala del 1 al 10. La mayoría de los encuestados (96.36%) se ubican dentro de dos desviaciones estándar de la media, indicando una alta concentración de respuestas en torno a los valores centrales. La mediana (9) y la media (8.47) son relativamente altas, sugiriendo un nivel general de satisfacción elevado en la muestra.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_hist</span><span class="p">(</span><span class="s1">&#39;J&#39;</span><span class="p">,</span><span class="s1">&#39;NPCJP9AA&#39;</span><span class="p">,</span><span class="s1">&#39;¿Estás satisfecho con tu vida?&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d5923ff133050f993d043f754635d0cb79494c55f2d3de7a2aec966b6b39c65d.png" src="../_images/d5923ff133050f993d043f754635d0cb79494c55f2d3de7a2aec966b6b39c65d.png" />
</div>
</div>
<p>Se presenta una visión general de las funciones utilizadas para analizar y visualizar datos de encuestas, incluyendo la distribución de edades por género y la satisfacción con la vida. Aunque no abarca todos los análisis realizados, demuestra el uso de histogramas, gráficos de densidad y estadísticas descriptivas para comprender patrones y tendencias en los datos. Estas herramientas son fundamentales para extraer información significativa y tomar decisiones basadas en evidencia a partir de los resultados de la encuesta.</p>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./docs"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="Referencias.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">10. Referencias</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-y-visualizacion-de-datos-con-python">Análisis y Visualización de Datos con Python</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#categorizacion-de-datos">Categorización de Datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#formato-visual-de-categorias">Formato Visual de Categorías</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#carga-y-filtrado-de-microdatos-del-dane">Carga y Filtrado de Microdatos del DANE</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#extraccion-de-metadatos">Extracción de Metadatos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unificacion-y-procesamiento-de-datos">Unificación y Procesamiento de Datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#estimacion-poblacional">Estimación Poblacional</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#desagregacion-y-analisis-de-datos">Desagregación y Análisis de Datos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-de-distribuciones">Visualización de Distribuciones</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lista-de-variables-sociodemograficas">Lista de Variables Sociodemográficas</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#analisis-de-datos-demograficos">Análisis de Datos Demográficos</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#distribucion-de-edades-por-genero">Distribución de Edades por Género</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#visualizacion-de-la-distribucion-de-probabilidad">Visualización de la Distribución de Probabilidad</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#distribucion-de-satisfaccion-con-la-vida">Distribución de Satisfacción con la Vida</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Circle Up Community ⚫
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright Living Stones 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>